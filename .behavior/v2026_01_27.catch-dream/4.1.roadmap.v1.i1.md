# roadmap: catch.dream ðŸŒ™

## refs

- wish: `.behavior/v2026_01_27.catch-dream/0.wish.md`
- vision: `.behavior/v2026_01_27.catch-dream/1.vision.md`
- blackbox criteria: `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md`
- coverage matrix: `.behavior/v2026_01_27.catch-dream/2.2.criteria.blackbox.matrix.md`
- prod patterns: `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.prod.v1.i1.md`
- test patterns: `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`
- domain distill: `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md`
- blueprint: `.behavior/v2026_01_27.catch-dream/3.3.blueprint.v1.i1.md`

---

## phase 0: pre-flight verification

### depends on
- (none â€” first phase)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/0.wish.md`
- `.behavior/v2026_01_27.catch-dream/3.3.blueprint.v1.i1.md`

### checklist

- [ ] **0.1** verify build passes
  ```bash
  npm run build
  ```

- [ ] **0.2** verify all tests pass
  ```bash
  npm run test:types && npm run test:unit && npm run test:integration
  ```

- [ ] **0.3** verify `domain-objects` package is available
  ```bash
  npm list domain-objects --depth=0
  ```

- [ ] **0.4** verify `iso-time` package is available
  ```bash
  npm list iso-time --depth=0
  ```

- [ ] **0.5** verify `BehaviorArtifact` pattern exists for reference
  ```bash
  ls src/domain.objects/BehaviorArtifact.ts
  ```

- [ ] **0.6** verify `init.behavior.ts` pattern exists for reference
  ```bash
  ls src/contract/cli/init.behavior.ts
  ```

### acceptance criteria
- build completes without errors
- all tests pass
- required packages are installed
- reference patterns exist

### verification
```bash
npm run build && npm run test
```

---

## phase 1: create DreamArtifact domain literal

### depends on
- phase 0 (pre-flight verification)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: literal.1 = DreamArtifact)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`
- `src/domain.objects/BehaviorArtifact.ts` (reference pattern)

### checklist

- [ ] **1.1** create directory `src/domain.objects/dreamer/`
  ```bash
  mkdir -p src/domain.objects/dreamer
  ```

- [ ] **1.2** create `src/domain.objects/dreamer/DreamArtifact.ts`
  - interface with: path, name, date (IsoDateStamp), filename
  - class extends DomainLiteral
  - static primary = ['path'] as const
  - static unique = ['path'] as const

- [ ] **1.3** create `src/domain.objects/dreamer/DreamArtifact.test.ts`
  - test: instantiation with valid props
  - test: primary key is path
  - test: unique key is path

- [ ] **1.4** verify unit tests pass
  ```bash
  npm run test:unit -- DreamArtifact.test.ts
  ```

### acceptance criteria
- `DreamArtifact` class exists with correct interface
- mirrors `BehaviorArtifact` pattern
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- DreamArtifact.test.ts
```

---

## phase 2: create DreamCandidate domain literal

### depends on
- phase 1 (DreamArtifact created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: literal.2 = DreamCandidate)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`

### checklist

- [ ] **2.1** create `src/domain.objects/dreamer/DreamCandidate.ts`
  - interface with: dream (DreamArtifact), distance (number)
  - class extends DomainLiteral
  - static nested = { dream: DreamArtifact }

- [ ] **2.2** create `src/domain.objects/dreamer/DreamCandidate.test.ts`
  - test: instantiation with valid props
  - test: nested DreamArtifact is hydrated

- [ ] **2.3** verify unit tests pass
  ```bash
  npm run test:unit -- DreamCandidate.test.ts
  ```

### acceptance criteria
- `DreamCandidate` class exists with nested hydration
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- DreamCandidate.test.ts
```

---

## phase 3: create normalizeDreamName operation

### depends on
- phase 0 (pre-flight verification)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.1 = normalizeDreamName)
- `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md` (episode.4 = input normalization)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`

### checklist

- [ ] **3.1** create directory `src/domain.operations/dreamer/dreams/`
  ```bash
  mkdir -p src/domain.operations/dreamer/dreams
  ```

- [ ] **3.2** create `src/domain.operations/dreamer/dreams/normalizeDreamName.ts`
  - pure function: (input: { raw: string }) => string
  - lowercase
  - special chars â†’ dash
  - collapse consecutive dashes
  - trim edge dashes

- [ ] **3.3** create `src/domain.operations/dreamer/dreams/normalizeDreamName.test.ts`
  - test: lowercase conversion ("Config-Reload" â†’ "config-reload")
  - test: spaces to dashes ("Config Hot Reload" â†’ "config-hot-reload")
  - test: special chars ("config@reload!" â†’ "config-reload")
  - test: collapse dashes ("config--reload" â†’ "config-reload")
  - test: trim edge dashes ("-config-" â†’ "config")
  - test: already kebab-case passes through

- [ ] **3.4** verify unit tests pass
  ```bash
  npm run test:unit -- normalizeDreamName.test.ts
  ```

### acceptance criteria
- pure function with no side effects
- handles all normalization cases from criteria
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- normalizeDreamName.test.ts
```

---

## phase 4: create genDreamDir operation

### depends on
- phase 0 (pre-flight verification)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.6 = genDreamDir)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.prod.v1.i1.md` (pattern.7 = directory creation)
- `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md` (episode.6 = dream folder bootstrap)

### checklist

- [ ] **4.1** create `src/domain.operations/dreamer/dreams/genDreamDir.ts`
  - input: { repoRoot: string }
  - output: { dreamDir: string; readmeCreated: boolean }
  - mkdir .dream/ (idempotent, recursive: true)
  - findsert .readme.md if absent

- [ ] **4.2** create `src/domain.operations/dreamer/dreams/genDreamDir.test.ts`
  - test: creates directory if absent
  - test: idempotent if directory exists
  - test: creates .readme.md if absent
  - test: skips .readme.md if present

- [ ] **4.3** create `src/domain.operations/dreamer/dreams/genDreamDir.integration.test.ts`
  - test: actually creates directory on filesystem
  - test: writes .readme.md with expected content

- [ ] **4.4** verify tests pass
  ```bash
  npm run test:unit -- genDreamDir.test.ts
  npm run test:integration -- genDreamDir.integration.test.ts
  ```

### acceptance criteria
- idempotent directory creation
- findserts .readme.md
- unit and integration tests pass

### verification
```bash
npm run test:types && npm run test:unit -- genDreamDir && npm run test:integration -- genDreamDir
```

---

## phase 5: create getOneDreamByName operation

### depends on
- phase 1 (DreamArtifact created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.2 = getOneDreamByName)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`

### checklist

- [ ] **5.1** create `src/domain.operations/dreamer/dreams/getOneDreamByName.ts`
  - input: { name: string; dreamDir: string }
  - output: Promise<DreamArtifact | null>
  - glob: `${dreamDir}/*.${name}.dream.md`
  - throw UnexpectedCodePathError if multiple matches
  - parse date from filename

- [ ] **5.2** create `src/domain.operations/dreamer/dreams/getOneDreamByName.test.ts`
  - test: returns null when no match
  - test: returns DreamArtifact when single match
  - test: throws when multiple matches
  - test: correctly parses date from filename

- [ ] **5.3** verify unit tests pass
  ```bash
  npm run test:unit -- getOneDreamByName.test.ts
  ```

### acceptance criteria
- glob pattern correctly matches dream files
- handles zero, one, and multiple matches
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- getOneDreamByName.test.ts
```

---

## phase 6: create setDream operation

### depends on
- phase 1 (DreamArtifact created)
- phase 5 (getOneDreamByName created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.5 = setDream)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.prod.v1.i1.md` (pattern.6 = findsert file operation)
- `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md` (episode.1, episode.2)

### checklist

- [ ] **6.1** create `src/domain.operations/dreamer/dreams/setDream.ts`
  - input: { findsert: { name: string; dreamDir: string } }
  - output: Promise<{ dream: DreamArtifact; outcome: 'caught' | 'found' }>
  - call getOneDreamByName first
  - if found â†’ return { dream, outcome: 'found' }
  - if not found â†’ create file, return { dream, outcome: 'caught' }
  - file content: "dream = \n\n"

- [ ] **6.2** create `src/domain.operations/dreamer/dreams/setDream.test.ts`
  - test: returns 'found' when prior dream exists
  - test: returns 'caught' when new dream created
  - test: file path format is correct

- [ ] **6.3** create `src/domain.operations/dreamer/dreams/setDream.integration.test.ts`
  - test: actually creates file on filesystem
  - test: file contains expected template
  - test: idempotent on second call

- [ ] **6.4** verify tests pass
  ```bash
  npm run test:unit -- setDream.test.ts
  npm run test:integration -- setDream.integration.test.ts
  ```

### acceptance criteria
- findsert pattern: find prior or create new
- correct file path format: `$isodate.$name.dream.md`
- correct template content
- unit and integration tests pass

### verification
```bash
npm run test:types && npm run test:unit -- setDream && npm run test:integration -- setDream
```

---

## phase 7: create getAllDreamsFromPastWeek operation

### depends on
- phase 1 (DreamArtifact created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.3 = getAllDreamsFromPastWeek)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`

### checklist

- [ ] **7.1** create `src/domain.operations/dreamer/dreams/getAllDreamsFromPastWeek.ts`
  - input: { dreamDir: string }
  - output: Promise<DreamArtifact[]>
  - glob all `*.dream.md` files
  - filter by date within past 7 days
  - parse name from filename

- [ ] **7.2** create `src/domain.operations/dreamer/dreams/getAllDreamsFromPastWeek.test.ts`
  - test: returns empty array when no dreams
  - test: includes dreams within 7 days
  - test: excludes dreams older than 7 days
  - test: correctly extracts name from filename

- [ ] **7.3** verify unit tests pass
  ```bash
  npm run test:unit -- getAllDreamsFromPastWeek.test.ts
  ```

### acceptance criteria
- filters by 7-day window
- parses filenames correctly
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- getAllDreamsFromPastWeek.test.ts
```

---

## phase 8: create getAllDreamsBySimilarity operation

### depends on
- phase 2 (DreamCandidate created)
- phase 7 (getAllDreamsFromPastWeek created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.4 = getAllDreamsBySimilarity)
- `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md` (episode.3 = fuzzy match recovery)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`

### checklist

- [ ] **8.1** create `src/domain.operations/dreamer/dreams/computeEditDistance.ts`
  - pure function: (a: string, b: string) => number
  - levenshtein distance implementation

- [ ] **8.2** create `src/domain.operations/dreamer/dreams/getAllDreamsBySimilarity.ts`
  - input: { name: string; dreamDir: string; threshold?: number }
  - output: Promise<DreamCandidate[]>
  - call getAllDreamsFromPastWeek
  - skip exact matches
  - compute edit distance for each
  - filter by threshold (default: 3)
  - sort by distance (lowest first)

- [ ] **8.3** create `src/domain.operations/dreamer/dreams/getAllDreamsBySimilarity.test.ts`
  - test: returns empty when no similar dreams
  - test: returns candidates within threshold
  - test: excludes exact matches
  - test: sorts by distance (lowest first)
  - test: respects custom threshold

- [ ] **8.4** verify unit tests pass
  ```bash
  npm run test:unit -- getAllDreamsBySimilarity.test.ts
  ```

### acceptance criteria
- edit distance calculation is correct
- threshold filter works
- sorted by distance
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- getAllDreamsBySimilarity.test.ts
```

---

## phase 9: create appendOntoDream operation

### depends on
- phase 1 (DreamArtifact created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.7 = appendOntoDream)
- `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md` (episode.3 = fuzzy match recovery, append scenario)

### checklist

- [ ] **9.1** create `src/domain.operations/dreamer/dreams/appendOntoDream.ts`
  - input: { from: DreamArtifact; onto: DreamArtifact }
  - output: Promise<void>
  - read content from both files
  - append with separator: "\n\n---\n\n"
  - write merged content to onto.path

- [ ] **9.2** create `src/domain.operations/dreamer/dreams/appendOntoDream.test.ts`
  - test: appends content with separator
  - test: preserves both contents

- [ ] **9.3** verify unit tests pass
  ```bash
  npm run test:unit -- appendOntoDream.test.ts
  ```

### acceptance criteria
- content merge with separator
- no data loss
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- appendOntoDream.test.ts
```

---

## phase 10: create deleteDream operation

### depends on
- phase 1 (DreamArtifact created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (section: operation.8 = deleteDream)
- `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md` (episode.3 = fuzzy match recovery, delete scenario)

### checklist

- [ ] **10.1** create `src/domain.operations/dreamer/dreams/deleteDream.ts`
  - input: { dream: DreamArtifact }
  - output: Promise<void>
  - fs.rm(dream.path, { force: true })

- [ ] **10.2** create `src/domain.operations/dreamer/dreams/deleteDream.test.ts`
  - test: deletes file if exists
  - test: no error if file absent (force: true)

- [ ] **10.3** verify unit tests pass
  ```bash
  npm run test:unit -- deleteDream.test.ts
  ```

### acceptance criteria
- file removal with force: true
- idempotent
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- deleteDream.test.ts
```

---

## phase 11: create runCatchDream composer

### depends on
- phase 3 (normalizeDreamName)
- phase 4 (genDreamDir)
- phase 6 (setDream)
- phase 8 (getAllDreamsBySimilarity)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.2.distill.domain._.v1.i1.md` (composition flow)
- `.behavior/v2026_01_27.catch-dream/3.3.blueprint.v1.i1.md` (section 3: codepaths)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.prod.v1.i1.md`
- `.behavior/v2026_01_27.catch-dream/1.vision.md` (example flows)

### checklist

- [ ] **11.1** create directory `src/domain.operations/dreamer/catch/`
  ```bash
  mkdir -p src/domain.operations/dreamer/catch
  ```

- [ ] **11.2** create `src/domain.operations/dreamer/catch/runCatchDream.ts`
  - input: { name: string; open?: string }
  - context: { repoRoot: string; log: LogMethods }
  - output: Promise<{ dream: DreamArtifact; outcome: 'caught' | 'found'; candidates: DreamCandidate[] }>
  - sequence:
    1. normalizeDreamName
    2. genDreamDir
    3. setDream
    4. openFileWithOpener (if open provided)
    5. getAllDreamsBySimilarity
    6. return result

- [ ] **11.3** create `src/domain.operations/dreamer/catch/runCatchDream.test.ts`
  - test: calls normalizeDreamName
  - test: calls genDreamDir
  - test: calls setDream
  - test: calls openFileWithOpener when open provided
  - test: skips openFileWithOpener when open absent
  - test: calls getAllDreamsBySimilarity
  - test: handles OpenerUnavailableError gracefully

- [ ] **11.4** create `src/domain.operations/dreamer/catch/runCatchDream.integration.test.ts`
  - test: end-to-end creates dream file
  - test: end-to-end finds prior dream

- [ ] **11.5** verify tests pass
  ```bash
  npm run test:unit -- runCatchDream.test.ts
  npm run test:integration -- runCatchDream.integration.test.ts
  ```

### acceptance criteria
- composes all operations correctly
- handles optional --open
- graceful error handler for opener
- unit and integration tests pass

### verification
```bash
npm run test:types && npm run test:unit -- runCatchDream && npm run test:integration -- runCatchDream
```

---

## phase 12: create catch.dream CLI entry point

### depends on
- phase 11 (runCatchDream created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.3.blueprint.v1.i1.md` (section 2.1: CLI contract)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.prod.v1.i1.md` (patterns 2-4, 10-11)
- `src/contract/cli/init.behavior.ts` (reference pattern)

### checklist

- [ ] **12.1** create `src/contract/cli/catch.dream.ts`
  - zod schema for args: { name: string, open?: string, ...rhachet passthrough }
  - getCliArgs({ schema })
  - validate --open has value if provided (empty string check)
  - getGitRoot()
  - call runCatchDream
  - render output with tree structure
  - handle fuzzy match candidates output

- [ ] **12.2** create `src/contract/cli/catch.dream.test.ts`
  - test: parses --name correctly
  - test: parses --open correctly
  - test: validates empty --open
  - test: ignores rhachet passthrough args

- [ ] **12.3** verify unit tests pass
  ```bash
  npm run test:unit -- catch.dream.test.ts
  ```

### acceptance criteria
- CLI arg parse works
- empty --open validation
- tree-style output format
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- catch.dream.test.ts
```

---

## phase 13: create catch.dream.sh shell skill

### depends on
- phase 12 (CLI entry point created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.prod.v1.i1.md` (pattern.1 = portable skill dispatch)
- `src/domain.roles/behaver/skills/init.behavior.sh` (reference pattern)

### checklist

- [ ] **13.1** create directory `src/domain.roles/dreamer/skills/`
  ```bash
  mkdir -p src/domain.roles/dreamer/skills
  ```

- [ ] **13.2** create `src/domain.roles/dreamer/skills/catch.dream.sh`
  ```bash
  #!/usr/bin/env bash
  set -euo pipefail
  exec node -e "import('rhachet-roles-bhuild').then(m => m.cli.catchDream())" -- "$@"
  ```

- [ ] **13.3** make executable
  ```bash
  chmod +x src/domain.roles/dreamer/skills/catch.dream.sh
  ```

- [ ] **13.4** verify skill file syntax
  ```bash
  bash -n src/domain.roles/dreamer/skills/catch.dream.sh
  ```

### acceptance criteria
- shell dispatcher uses portable node -e pattern
- executable permission set
- bash syntax valid

### verification
```bash
bash -n src/domain.roles/dreamer/skills/catch.dream.sh && echo "syntax OK"
```

---

## phase 14: create getDreamerRole definition

### depends on
- phase 13 (shell skill created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/0.wish.md` (dreamer role concept)
- `src/domain.roles/behaver/getBehaverRole.ts` (reference pattern)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`

### checklist

- [ ] **14.1** create directory `src/domain.roles/dreamer/`
  ```bash
  mkdir -p src/domain.roles/dreamer
  ```

- [ ] **14.2** create `src/domain.roles/dreamer/readme.md`
  - describe the dreamer role
  - mention ðŸŒ™ mascot

- [ ] **14.3** create `src/domain.roles/dreamer/getDreamerRole.ts`
  - Role.build with slug: 'dreamer'
  - skills.dirs: [{ uri: __dirname + '/skills' }]
  - purpose: catches transient ideas without focus loss

- [ ] **14.4** create `src/domain.roles/dreamer/getDreamerRole.test.ts`
  - test: role slug is 'dreamer'
  - test: skills directory is configured
  - test: purpose is defined

- [ ] **14.5** verify unit tests pass
  ```bash
  npm run test:unit -- getDreamerRole.test.ts
  ```

### acceptance criteria
- dreamer role definition complete
- skills directory configured
- unit tests pass

### verification
```bash
npm run test:types && npm run test:unit -- getDreamerRole.test.ts
```

---

## phase 15: update src/index.ts exports

### depends on
- phase 12 (CLI entry point created)
- phase 14 (role definition created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.prod.v1.i1.md` (pattern.2 = cli module registration)
- `src/index.ts` (current exports)

### checklist

- [ ] **15.1** add cli.catchDream export to `src/index.ts`
  ```typescript
  import { catchDream } from './contract/cli/catch.dream';

  export const cli = {
    // ... other exports
    catchDream: () => withEmojiSpaceShim({ logic: async () => catchDream() }),
  };
  ```

- [ ] **15.2** add dreamer role export (if roles are exported)

- [ ] **15.3** verify build succeeds
  ```bash
  npm run build
  ```

- [ ] **15.4** verify export is accessible
  ```bash
  node -e "import('rhachet-roles-bhuild').then(m => console.log(typeof m.cli.catchDream))"
  ```

### acceptance criteria
- cli.catchDream is exported
- build succeeds
- export is accessible via node import

### verification
```bash
npm run build && node -e "import('rhachet-roles-bhuild').then(m => console.log(typeof m.cli.catchDream))"
# expected output: "function"
```

---

## phase 16: create acceptance tests

### depends on
- phase 15 (exports updated)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/2.1.criteria.blackbox.md` (all episodes)
- `.behavior/v2026_01_27.catch-dream/2.2.criteria.blackbox.matrix.md`
- `.behavior/v2026_01_27.catch-dream/1.vision.md` (example flows)
- `.behavior/v2026_01_27.catch-dream/3.1.research.patterns._.code.test.v1.i1.md`

### checklist

- [ ] **16.1** create directory `blackbox/role=dreamer/`
  ```bash
  mkdir -p blackbox/role=dreamer
  ```

- [ ] **16.2** create test assets directory
  ```bash
  mkdir -p blackbox/role=dreamer/.test/assets
  ```

- [ ] **16.3** create `blackbox/role=dreamer/skill.catch.dream.acceptance.test.ts`

- [ ] **16.4** implement episode.1 tests: catch a new dream
  - test: file created with correct path format
  - test: file contains "dream = " template
  - test: output shows "ðŸŒ™ dream caught"

- [ ] **16.5** implement episode.2 tests: return to prior dream
  - test: no new file created
  - test: output shows "ðŸŒ™ dream found"
  - test: output shows "tip: use --open..." when no --open

- [ ] **16.6** implement episode.4 tests: input normalization
  - test: spaces converted to dashes
  - test: special chars handled

- [ ] **16.7** implement episode.5 tests: error scenarios
  - test: error when outside git repo
  - test: error when --name absent
  - test: warn when editor not found

- [ ] **16.8** implement episode.6 tests: dream folder bootstrap
  - test: .dream/ folder created
  - test: .readme.md created

- [ ] **16.9** verify acceptance tests pass
  ```bash
  npm run test:acceptance -- catch.dream.acceptance.test.ts
  ```

### acceptance criteria
- all blackbox criteria episodes covered
- tests use given/when/then structure
- tests are blackbox (only via CLI contract)

### verification
```bash
npm run test:acceptance -- catch.dream.acceptance.test.ts
```

---

## phase 17: full verification

### depends on
- phase 16 (acceptance tests created)

### briefs to read
- `.behavior/v2026_01_27.catch-dream/3.3.blueprint.v1.i1.md` (section 9: verification checklist)

### checklist

- [ ] **17.1** rebuild project
  ```bash
  npm run build
  ```

- [ ] **17.2** run all type checks
  ```bash
  npm run test:types
  ```

- [ ] **17.3** run all unit tests
  ```bash
  npm run test:unit
  ```

- [ ] **17.4** run all integration tests
  ```bash
  npm run test:integration
  ```

- [ ] **17.5** run all acceptance tests
  ```bash
  npm run test:acceptance
  ```

- [ ] **17.6** manual verification: catch new dream
  ```bash
  npm run build && npx rhachet roles link --role dreamer
  npx rhachet run --skill catch.dream --name test-dream
  cat .dream/*.test-dream.dream.md
  ```

- [ ] **17.7** manual verification: find prior dream
  ```bash
  npx rhachet run --skill catch.dream --name test-dream
  # should output "ðŸŒ™ dream found"
  ```

- [ ] **17.8** cleanup test dream
  ```bash
  rm .dream/*.test-dream.dream.md
  ```

### acceptance criteria
- all tests pass
- skill works end-to-end
- output format matches vision

### verification
```bash
npm run build && npm run test:types && npm run test:unit && npm run test:integration && npm run test:acceptance
```

---

## summary checklist

| phase | description                           | status |
| ----- | ------------------------------------- | ------ |
| 0     | pre-flight verification               | [ ]    |
| 1     | DreamArtifact domain literal          | [ ]    |
| 2     | DreamCandidate domain literal         | [ ]    |
| 3     | normalizeDreamName operation          | [ ]    |
| 4     | genDreamDir operation                 | [ ]    |
| 5     | getOneDreamByName operation           | [ ]    |
| 6     | setDream operation                    | [ ]    |
| 7     | getAllDreamsFromPastWeek operation    | [ ]    |
| 8     | getAllDreamsBySimilarity operation    | [ ]    |
| 9     | appendOntoDream operation             | [ ]    |
| 10    | deleteDream operation                 | [ ]    |
| 11    | runCatchDream composer                | [ ]    |
| 12    | catch.dream CLI entry point           | [ ]    |
| 13    | catch.dream.sh shell skill            | [ ]    |
| 14    | getDreamerRole definition             | [ ]    |
| 15    | update src/index.ts exports           | [ ]    |
| 16    | acceptance tests                      | [ ]    |
| 17    | full verification                     | [ ]    |

---

## rollback plan

if implementation fails at any phase:

1. revert uncommitted changes
   ```bash
   git checkout -- .
   ```

2. if committed, revert to prior commit
   ```bash
   git reset --hard HEAD~1
   ```

3. verify tests still pass
   ```bash
   npm run build && npm run test
   ```

---

ðŸŒ™
