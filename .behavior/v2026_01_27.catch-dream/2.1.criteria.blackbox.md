# blackbox criteria: catch.dream ğŸŒ™

## episode.1 = catch a new dream

```
given('a repo with no prior dreams')
  when('user runs catch.dream --name "config-reload" --open codium')
    then('file .dream/2026_01_27.config-reload.dream.md is created')
      sothat('dream is persisted before it fades')
    then('file contains "dream = " as starter template')
      sothat('user has consistent structure to write into')
    then('output shows "ğŸŒ™ dream caught" with file path')
      sothat('user knows where dream was saved')
    then('output shows "opened in codium"')
      sothat('user knows editor launched')
    then('editor opens the file')
      sothat('user can immediately write their dream')
```

## episode.2 = return to prior dream

```
given('a repo with prior dream .dream/2026_01_20.config-reload.dream.md')
  when('user runs catch.dream --name "config-reload" --open codium')
    then('no new file is created')
      sothat('dreams are not duplicated')
    then('output shows "ğŸŒ™ dream found" with prior file path')
      sothat('user knows prior dream was located')
    then('output shows "opened in codium"')
    then('editor opens the prior file')
      sothat('user can add to their prior dream')

  when('user runs catch.dream --name "config-reload" (no --open)')
    then('output shows "ğŸŒ™ dream found" with prior file path')
    then('output shows "tip: use --open to open the dream automatically"')
      sothat('user learns about --open option')
```

## episode.3 = fuzzy match recovery (typo scenario)

```
given('a repo with prior dream .dream/2026_01_25.config-reload.dream.md from past week')
  when('user runs catch.dream --name "config-relod" --open codium')  # typo
    then('new file .dream/2026_01_27.config-relod.dream.md is created')
    then('editor opens the new file')
      sothat('user can start capture immediately (no latency)')
    then('output shows "ğŸŒ™ dream caught"')
    then('output shows "ğŸ’­ related dreams from past week" with numbered list')
      sothat('user sees similar dreams they may have meant')
    then('output prompts "reuse? [1/2/n]:"')
      sothat('user can recover from typo')

  when('user selects "1" and new file is empty')
    then('new file is deleted')
    then('prior dream file is opened')
      sothat('user continues in correct dream')

  when('user selects "1" and new file has content')
    then('prompt asks "append to prior dream? [y/n]"')
      sothat('user content is not lost')

    when('user selects "y"')
      then('new file content is appended to prior dream')
      then('new file is deleted')
      then('prior dream file is opened')

    when('user selects "n"')
      then('both files are kept')
      then('no content is lost')

  when('user selects "n"')
    then('new file is kept')
    then('no prompt for append')
      sothat('user can intentionally have similar-named dreams')
```

## episode.4 = input normalization

```
given('a repo')
  when('user runs catch.dream --name "Config Hot Reload"')
    then('file is created as .dream/2026_01_27.config-hot-reload.dream.md')
      sothat('names are normalized to kebab-case')

  when('user runs catch.dream --name "config@reload!"')
    then('file is created as .dream/2026_01_27.config-reload-.dream.md')
      sothat('special characters are replaced with - and filenames remain valid')
```

## episode.5 = error scenarios

```
given('user is outside any git repo')
  when('user runs catch.dream --name "some-idea"')
    then('error message shows "no git repo found"')
    then('no file is created')
      sothat('dreams stay repo-scoped')

given('a repo')
  when('user runs catch.dream --name "idea" --open nonexistent-editor')
    then('file is created')
    then('output shows warn about editor not found')
    then('output shows file path')
      sothat('user can still find and open the file manually')

  when('user runs catch.dream without --name')
    then('error message shows --name is required')
      sothat('user knows what input is needed')
```

## episode.6 = dream folder bootstrap

```
given('a repo with no .dream/ folder')
  when('user runs catch.dream --name "first-idea" --open codium')
    then('.dream/ folder is created')
    then('.dream/.readme.md is findserted')
      sothat('future travelers discover what this folder is')
    then('.readme.md explains this is a dreamcatcher and how to use it')
      sothat('folder explains itself')
    then('file .dream/2026_01_27.first-idea.dream.md is created')
    then('no error or warn about folder creation')
      sothat('first-time use is frictionless')
```

## exchange.1 = catch.dream command

```
input:
  --name <dreamname>     # required, the dream identifier
  --open <editor>        # optional, editor to open with

output.success:
  ğŸŒ™ dream caught|found
     â”œâ”€ .dream/$isodate.$dreamname.dream.md
     â””â”€ opened in $editor | tip: use --open to open the dream automatically

output.fuzzy_match:
  ğŸ’­ related dreams from past week
     â”œâ”€ 1. $dreamname ($date)
     â”œâ”€ 2. $dreamname ($date)
     â””â”€ reuse? [1/2/n]:

output.error:
  - "no git repo found" (outside repo)
  - "--name is required" (name absent)
  - "âš ï¸ $editor not found, file at: ..." (bad editor)
```

## exchange.2 = dream file format

```
input: (user writes into file)

output.template:
  dream =

output.location:
  .dream/$isodate.$dreamname.dream.md

output.isodate_format:
  YYYY_MM_DD (e.g., 2026_01_27)

output.dreamname_format:
  kebab-case (e.g., config-hot-reload)
```
