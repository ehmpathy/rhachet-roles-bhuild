# research: oss levers for give.feedback tune (v2 - trimmed)

## summary

recommended stack for give.feedback --talk repl:

| criterion | tool | rationale |
|-----------|------|-----------|
| repl ui framework | **ink** | flexbox layout for footer below input |
| inline multiline | **ink-multiline-input** | shift+enter/alt+enter configurable |
| colors | **picocolors** | tiny, fast |
| file ops | **fs.appendFile** | built-in, atomic for appends |
| editor open | shell command | same pattern as give.behavior |
| tree symbols | hardcoded unicode | no windows support needed |

---

## 1. ink (react for cli)

**what**: react-based library for interactive cli apps

**who uses it**: gatsby, github copilot, prisma, shopify cli, cloudflare wrangler, terraform cdk [1]

**key features**:
- "box works like a container of display: flex; on the web" [3]
- "ink has full typescript support. the library ships with type definitions" [2]
- flexDirection column + Spacer enables footer layout

**footer layout pattern**:
```jsx
import { render, Box, Text, Spacer } from 'ink';

const FeedbackRepl = () => (
  <Box flexDirection="column" height={15}>
    {/* input area above */}
    <MultilineInput ... />

    {/* spacer pushes footer to bottom */}
    <Spacer />

    {/* footer below (like claude code) */}
    <Box>
      <Text color="cyan"># blocker.3 &gt;</Text>
    </Box>
  </Box>
);
```

[1] https://github.com/vadimdemedes/ink
[2] https://news.ycombinator.com/item?id=42016639
[3] https://blog.logrocket.com/ui-ink-react-build-interactive-custom-clis/

---

## 2. ink-multiline-input

**what**: multiline text input component for ink with configurable keybindings

**key features**:
- vertical scroll that keeps cursor in view
- arrow key navigation (up, down, left, right)
- backspace and delete support
- customizable keybindings for submit vs newline

**shift+enter / alt+enter config**:
```jsx
import { MultilineInput } from "ink-multiline-input";

<MultilineInput
  value={value}
  onChange={setValue}
  rows={3}
  maxRows={10}
  placeholder="type feedback here..."
  onSubmit={(val) => submitFeedback(val)}
  keyBindings={{
    submit: (key) => key.return && !key.shift && !key.meta,  // enter alone
    newline: (key) => (key.shift && key.return) || (key.meta && key.return),  // shift+enter or alt+enter
  }}
/>
```

[4] https://libraries.io/npm/ink-multiline-input

---

## 3. picocolors

**what**: tiny terminal color library

**size**: "14 times smaller and 2 times faster than chalk" [5]

**usage**:
```js
import pc from 'picocolors';

console.log(pc.cyan('# blocker.3 >'));
console.log(pc.red('blocker'));
console.log(pc.yellow('nitpick'));
```

[5] https://dev.to/webdiscus/comparison-of-nodejs-libraries-to-colorize-text-in-terminal-4j3a

---

## 4. fs.appendFile (built-in)

**what**: append data to file atomically

**behavior**: "if you do append writes it is always atomic" [6]

**usage for jsonl change log**:
```js
import { appendFile } from 'fs/promises';

const changeEvent = { index: 3, severity: 'blocker', before: null, after: 'feedback text' };
await appendFile('.log/changes.jsonl', JSON.stringify(changeEvent) + '\n');
```

[6] https://groups.google.com/g/nodejs/c/sPPM8Y7v6BY

---

## 5. editor open (shell command)

**pattern**: same as give.behavior skill

```bash
# open in codium
codium "$FEEDBACK_PATH"

# open in vscode
code "$FEEDBACK_PATH"
```

no npm dep needed - invoke via child_process.exec or execa.

---

## 6. tree symbols (hardcoded)

**pattern**: hardcoded unicode, no fallback needed

```js
const TREE = {
  branch: 'â”œâ”€',
  last: 'â””â”€',
  pipe: 'â”‚',
};

console.log(`ðŸ¦« wassup?`);
console.log(`   ${TREE.branch} ${relativePath}`);
console.log(`   ${TREE.last} ${action}`);
```

---

## complete example: feedback repl

```jsx
import React, { useState } from 'react';
import { render, Box, Text, Spacer, useInput } from 'ink';
import { MultilineInput } from 'ink-multiline-input';

const FeedbackRepl = ({ onSubmit }) => {
  const [value, setValue] = useState('');
  const [severity, setSeverity] = useState('blocker');
  const [blockerCount, setBlockerCount] = useState(0);
  const [nitpickCount, setNitpickCount] = useState(0);

  // shift+tab to toggle severity
  useInput((input, key) => {
    if (key.shift && key.tab) {
      setSeverity(s => s === 'blocker' ? 'nitpick' : 'blocker');
    }
  });

  const nextIndex = severity === 'blocker' ? blockerCount + 1 : nitpickCount + 1;
  const header = `# ${severity}.${nextIndex}`;

  const handleSubmit = (text) => {
    if (!text.trim()) return;
    onSubmit({ severity, index: nextIndex, text });
    if (severity === 'blocker') setBlockerCount(c => c + 1);
    else setNitpickCount(c => c + 1);
    setValue('');
  };

  return (
    <Box flexDirection="column" height={15}>
      {/* input area */}
      <MultilineInput
        value={value}
        onChange={setValue}
        rows={5}
        maxRows={10}
        onSubmit={handleSubmit}
        keyBindings={{
          submit: (key) => key.return && !key.shift && !key.meta,
          newline: (key) => (key.shift && key.return) || (key.meta && key.return),
        }}
      />

      <Spacer />

      {/* footer */}
      <Box>
        <Text color={severity === 'blocker' ? 'red' : 'yellow'}>
          {header} &gt;
        </Text>
        <Text dimColor> (shift+tab to toggle, enter to submit)</Text>
      </Box>
    </Box>
  );
};
```

---

## deps summary

```json
{
  "dependencies": {
    "ink": "^5.0.0",
    "ink-multiline-input": "^0.1.0",
    "picocolors": "^1.0.0",
    "react": "^18.0.0"
  }
}
```

total: 4 runtime deps (+ react transitive deps from ink)
