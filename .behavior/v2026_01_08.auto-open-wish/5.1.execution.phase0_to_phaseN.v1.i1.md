# execution: auto-open-wish

## progress

- [x] phase 1.1: computeOutputTree + tests
- [x] phase 1.2: computeFooterOutput + tests
- [x] phase 2.1: OpenerUnavailableError
- [x] phase 2.2: openFileWithOpener + tests
- [x] phase 3.1: init.behavior.ts orchestrator
- [x] phase 4.1: acceptance tests
- [x] phase 5.1: smoke test (via acceptance tests)

---

## phase 1.1: computeOutputTree

**status:** complete

### files created:
- `src/domain.operations/behavior/init/computeOutputTree.ts`
- `src/domain.operations/behavior/init/computeOutputTree.test.ts`

### verification:
```sh
npm run test:unit -- computeOutputTree.test.ts
# 10 tests passed
```

---

## phase 1.2: computeFooterOutput

**status:** complete

### files created:
- `src/domain.operations/behavior/render/computeFooterOutput.ts`
- `src/domain.operations/behavior/render/computeFooterOutput.test.ts`

### verification:
```sh
npm run test:unit -- computeFooterOutput.test.ts
# 4 tests passed
```

---

## phase 2.1: OpenerUnavailableError

**status:** complete

### files created:
- `src/infra/shell/OpenerUnavailableError.ts`

---

## phase 2.2: openFileWithOpener

**status:** complete

### files created:
- `src/infra/shell/openFileWithOpener.ts`
- `src/infra/shell/openFileWithOpener.integration.test.ts`

### verification:
```sh
npm run test:integration -- openFileWithOpener.integration.test.ts
# 5 tests passed
```

---

## phase 3.1: init.behavior.ts orchestrator

**status:** complete

### files modified:
- `src/contract/cli/init.behavior.ts` - added imports, --open schema, computeOutputTree, computeFooterOutput, openFileWithOpener
- `src/domain.operations/behavior/init/index.ts` - added computeOutputTree export

### changes:
- added `open: z.string().optional()` to schema
- replaced console.log loops with `computeOutputTree()` call
- replaced success message with `computeFooterOutput()` call
- added opener execution with try/catch for `OpenerUnavailableError`

---

## phase 4.1: acceptance tests

**status:** complete

### files modified:
- `blackbox/role=behaver/skill.init.behavior.acceptance.test.ts`
  - updated old assertions to expect new output format ("ðŸ¦« oh, behave!")
  - added [case6] for --open flag with cat command
  - added [case7] for --open flag with unavailable command

### verification:
```sh
npm run test:acceptance -- skill.init.behavior.acceptance.test.ts
# 14 tests passed
```

---

## phase 5.1: smoke test

**status:** complete (via acceptance tests)

the acceptance tests comprehensively verify:
1. vibed output format with "ðŸ¦« oh, behave!" header
2. tree-style file list with + for created, âœ“ for kept
3. footer with "ðŸŒ² go on then," and relative wish path
4. --open flag functionality (with cat)
5. warn when opener is unavailable

---

## summary

all phases complete. the `init.behavior` skill now:

1. **vibed output**: displays tree-style output with unicode symbols
   - header: "ðŸ¦« oh, behave!"
   - file symbols: + (created), âœ“ (kept), â†» (updated)
   - tree chars: â”œâ”€, â””â”€

2. **relative path**: shows relative path to wish file in footer
   - "ðŸŒ² go on then,"
   - "   â””â”€ .behavior/vYYYY_MM_DD.name/0.wish.md"

3. **--open flag**: auto-opens wish file with specified editor
   - `--open vim` runs: `vim .behavior/.../0.wish.md`
   - warns if opener unavailable but init still succeeds

### test results:
- unit tests: 14 passed
- integration tests: 5 passed
- acceptance tests: 14 passed
- types: compile clean
