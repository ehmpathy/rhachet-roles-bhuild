# vision: standardized self-review frame

## the outcome world

### before: adhoc review prompts

guard files contained inconsistent, situation-specific review prompts:

```yaml
# execution guard
- slug: all-done-self
  say: are you sure all was completed? review the blueprint and criteria...

# blueprint guard
- slug: all-done-self
  say: are you sure all of the criteria and vision was covered?...

# criteria guard
- slug: all-real-junior
  say: a junior recently worked on this criteria. are there any unquestioned assumptions...
```

problems:
- prompts phrased differently each time
- unclear what dimensions the review targets
- absent coverage in some guards
- no systematic mental model

### after: standardized review frame

guard files use a consistent frame based on two orthogonal dimensions:

**dimension 1: what do we review against?**
- `role.standards` - mechanic best practices, patterns, conventions
- `behavior.declaration` - the behavior's vision, criteria, blueprint

**dimension 2: what aspect do we check?**
- `coverage` - is all accounted for? any omissions?
- `adherance` - does what exists follow the rules correctly?

this produces 4 fundamental review types:

```
                  coverage        adherance
                ┌─────────────┬─────────────┐
  role.standards│ omitted     │ violations  │
                │ practices   │ of rules    │
                ├─────────────┼─────────────┤
  behavior.decl │ omitted     │ spec        │
                │ features    │ drift       │
                └─────────────┴─────────────┘
```

| reviewable | coverage | adherance |
|------------|----------|-----------|
| role.standards | are all relevant standards applied? | do implementations follow the standards? |
| behavior.declaration | are all requirements covered? | does implementation match the spec? |

### the "aha" moment

the frame clicks when you realize:

> every code review really asks: "did we cover all?" and "did we do it right?"

those two questions apply to both:
- the role's standards (mechanic patterns)
- the behavior's declaration (vision + criteria + blueprint)

the 2x2 matrix gives complete coverage with minimal concepts.

---

## user experience

### usecases

1. **behavior author** defines guard files with standardized reviews
2. **behaver agent** executes self-reviews before human approval request
3. **human reviewer** sees consistent reports with clear dimensions

### contract shape

```yaml
# guard file structure
reviews:
  self:
    # 1. review against behavior declaration - coverage
    - slug: behavior.declaration.coverage
      say: |
        review for coverage of the behavior declaration.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have omitted
        requirements or left features unimplemented.

        go through the behavior's vision, criteria, and blueprint, then check
        each requirement against the code line by line:
        - is every requirement from the vision addressed?
        - is every criterion from the criteria satisfied?
        - is every component from the blueprint implemented?
        - did the junior skip or forget any part of the spec?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.behavior.declaration.coverage.md
        then fix all gaps before you continue.

    # 2. review against behavior declaration - adherance
    - slug: behavior.declaration.adherance
      say: |
        review for adherance to the behavior declaration.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have drifted
        from the spec or implemented items incorrectly.

        go through each file changed in this pr, line by line, and check
        against the behavior's vision, criteria, and blueprint:
        - does the implementation match what the vision describes?
        - does the implementation satisfy the criteria correctly?
        - does the implementation follow the blueprint accurately?
        - did the junior misinterpret or deviate from the spec?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.behavior.declaration.adherance.md
        then fix all gaps before you continue.

    # 3. review against role standards - adherance
    - slug: role.standards.adherance
      say: |
        review for adherance to mechanic role standards.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have introduced
        bad practices or violated patterns that we require.

        go through each file changed in this pr, line by line, and check:
        - does the code follow mechanic standards correctly?
        - are there violations of required patterns?
        - did the junior introduce anti-patterns, bad practices, or deviations from our conventions?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.role.standards.adherance.md
        then fix all gaps before you continue.

    # 4. review against role standards - coverage
    - slug: role.standards.coverage
      say: |
        review for coverage of mechanic role standards.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have forgotten
        best practices or omitted patterns that should be present.

        go through each file changed in this pr, line by line, and check:
        - are all relevant mechanic standards applied?
        - are there patterns that should be present but are absent?
        - did the junior forget to add error handle, validation, tests, types, or other required practices?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.role.standards.coverage.md
        then fix all gaps before you continue.
```

### timeline

1. `rhx init.behavior` scaffolds guards with standardized review frame
2. behaver reaches execution stone
3. guard triggers self-reviews in standard order
4. behaver emits reports: `.behavior/$thisBehavior/reviews/5.1.execution.role.standards.coverage.md`
5. behaver fixes any gaps found
6. behaver requests human approval

---

## mental model

### how users describe it

> "self-reviews check two sources against two aspects: did we cover all, and did we do it right, for both our standards and the behavior spec"

### analogies

**the checklist pilot**: pilots use checklists that cover both aircraft procedures (standards) and flight plan requirements (mission spec). each item checks both "is it present?" and "is it correct?"

**the code review quadrant**:
```
                    coverage    adherance
                  ┌───────────┬───────────┐
role.standards    │ omitted   │ violations│
                  │ practices │ of rules  │
                  ├───────────┼───────────┤
behavior.decl     │ omitted   │ spec      │
                  │ features  │ drift     │
                  └───────────┴───────────┘
```

### terminology alignment

| user term | our term |
|-----------|----------|
| "did we forget any?" | coverage |
| "did we do it right?" | adherance |
| "code standards" | role.standards |
| "the spec" / "requirements" | behavior.declaration |

---

## evaluation

### how well does it solve the goals?

| goal | solved? |
|------|---------|
| standardize adhoc prompts | yes - 4 canonical review types |
| ensure complete coverage | yes - 2x2 matrix is exhaustive |
| clear mental model | yes - two simple dimensions |
| junior-proof | yes - explicit coverage + adherance catches omissions and violations |

### pros

- **exhaustive**: 2x2 covers all review dimensions
- **memorable**: two questions x two sources
- **composable**: guards can include subset of reviews as needed
- **debuggable**: clear which quadrant found issues

### cons

- **verbosity**: 4 reviews instead of 1-2 adhoc prompts
- **overhead**: may be excessive for simple stones

### pit of success

the frame keeps users safe by:
- default to all 4 reviews for execution stones (most risk)
- allow subset for earlier stones (vision, criteria)
- standardized report paths: `.behavior/$thisBehavior/reviews/{stone}.{slug}.md`
- mandatory fix step after each review

### edgecases

| edgecase | handle |
|----------|--------|
| stone has no role standards | omit role.standards reviews |
| stone is pure research | use behavior.declaration reviews only |
| execution spans multiple phases | reviews at each phase boundary |
