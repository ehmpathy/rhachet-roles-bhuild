# blueprint: standardized self-review frame

## summary

update the guard templates in `src/domain.operations/behavior/init/templates/` to use the standardized 2x2 self-review frame:

```
                  coverage        adherance
                ┌─────────────┬─────────────┐
  role.standards│ omitted     │ violations  │
                │ practices   │ of rules    │
                ├─────────────┼─────────────┤
  behavior.decl │ omitted     │ spec        │
                │ features    │ drift       │
                └─────────────┴─────────────┘
```

priority order:
1. `behavior.declaration.coverage`
2. `behavior.declaration.adherance`
3. `role.standards.adherance`
4. `role.standards.coverage`

---

## filediffs

```
src/domain.operations/behavior/init/templates/
├── [~] 5.1.execution.phase0_to_phaseN.v1.guard   # replace adhoc reviews with standardized 4-review frame
├── [~] 3.3.blueprint.v1.guard                    # replace adhoc reviews with standardized 4-review frame
├── [○] 2.1.criteria.blackbox.guard               # retain - criteria review is distinct (question assumptions)
└── [○] 1.vision.guard                            # retain - no self-reviews needed for vision
```

---

## codepaths

```
5.1.execution.phase0_to_phaseN.v1.guard
├── [-] reviews.self[slug=all-done-self]
├── [-] reviews.self[slug=all-done-junior]
├── [+] reviews.self[slug=behavior.declaration.coverage]
├── [+] reviews.self[slug=behavior.declaration.adherance]
├── [+] reviews.self[slug=role.standards.adherance]
└── [+] reviews.self[slug=role.standards.coverage]

3.3.blueprint.v1.guard
├── [-] reviews.self[slug=all-done-self]
├── [-] reviews.self[slug=all-done-junior]
├── [-] reviews.self[slug=all-simple-junior]
├── [+] reviews.self[slug=behavior.declaration.coverage]
├── [+] reviews.self[slug=behavior.declaration.adherance]
├── [+] reviews.self[slug=role.standards.adherance]
├── [+] reviews.self[slug=role.standards.coverage]
└── [○] judges[mechanism=approved?]
```

---

## contracts

### guard file structure

each guard with self-reviews will follow this structure:

```yaml
# guard for {stone} stone
# includes standardized self-review frame

reviews:
  self:
    # 1. review against behavior declaration - coverage
    - slug: behavior.declaration.coverage
      say: |
        review for coverage of the behavior declaration.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have omitted
        requirements or left features unimplemented.

        go through the behavior's vision, criteria, and blueprint, then check
        each requirement against the code line by line:
        - is every requirement from the vision addressed?
        - is every criterion from the criteria satisfied?
        - is every component from the blueprint implemented?
        - did the junior skip or forget any part of the spec?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.behavior.declaration.coverage.md
        then fix all gaps before you continue.

    # 2. review against behavior declaration - adherance
    - slug: behavior.declaration.adherance
      say: |
        review for adherance to the behavior declaration.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have drifted
        from the spec or implemented items incorrectly.

        go through each file changed in this pr, line by line, and check
        against the behavior's vision, criteria, and blueprint:
        - does the implementation match what the vision describes?
        - does the implementation satisfy the criteria correctly?
        - does the implementation follow the blueprint accurately?
        - did the junior misinterpret or deviate from the spec?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.behavior.declaration.adherance.md
        then fix all gaps before you continue.

    # 3. review against role standards - adherance
    - slug: role.standards.adherance
      say: |
        review for adherance to mechanic role standards.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have introduced
        bad practices or violated patterns that we require.

        go through each file changed in this pr, line by line, and check:
        - does the code follow mechanic standards correctly?
        - are there violations of required patterns?
        - did the junior introduce anti-patterns, bad practices, or deviations from our conventions?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.role.standards.adherance.md
        then fix all gaps before you continue.

    # 4. review against role standards - coverage
    - slug: role.standards.coverage
      say: |
        review for coverage of mechanic role standards.

        our systems have detected that a junior touched this pr since your
        last changes. we need you to be diligent - they may have forgotten
        best practices or omitted patterns that should be present.

        go through each file changed in this pr, line by line, and check:
        - are all relevant mechanic standards applied?
        - are there patterns that should be present but are absent?
        - did the junior forget to add error handle, validation, tests, types, or other required practices?

        emit your findings to .behavior/$thisBehavior/reviews/{stone}.role.standards.coverage.md
        then fix all gaps before you continue.

judges:
  - npx rhachet run --repo bhrain --skill route.stone.judge --mechanism approved? --stone $stone --route $route
```

---

## report output paths

reports emit to `.behavior/$thisBehavior/reviews/` with standardized names:

```
.behavior/$thisBehavior/reviews/
├── 5.1.execution.behavior.declaration.coverage.md
├── 5.1.execution.behavior.declaration.adherance.md
├── 5.1.execution.role.standards.adherance.md
├── 5.1.execution.role.standards.coverage.md
├── 3.3.blueprint.behavior.declaration.coverage.md
├── 3.3.blueprint.behavior.declaration.adherance.md
├── 3.3.blueprint.role.standards.adherance.md
└── 3.3.blueprint.role.standards.coverage.md
```

---

## what changes

| file | before | after |
|------|--------|-------|
| `5.1.execution...guard` | 2 adhoc reviews (`all-done-self`, `all-done-junior`) | 4 standardized reviews |
| `3.3.blueprint...guard` | 3 adhoc reviews (`all-done-self`, `all-done-junior`, `all-simple-junior`) | 4 standardized reviews |
| `2.1.criteria...guard` | 1 specific review (`all-real-junior`) | retain as-is |
| `1.vision.guard` | no self-reviews | retain as-is |

---

## test coverage

no new tests needed - this is a template content change, not behavior change.

the acceptance tests in `blackbox/role=behaver/skill.init.behavior.guards.acceptance.test.ts` already verify guard file creation. the test may need snapshot updates if it checks guard content.
